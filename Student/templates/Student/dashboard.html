{% extends 'Student/base.html' %}
{% load static %}

{% block title %}Student Dashboard{% endblock %}

{% block content %}

<!-- Page Title -->
<div class="mb-8">
    <h2 class="text-4xl font-extrabold bg-gradient-to-r from-gm-primary to-indigo-500 text-transparent bg-clip-text">
        Student Dashboard
    </h2>
    <p class="text-gray-600 mt-1">Your academic overview at a glance.</p>
</div>

<!-- Statistics Cards -->
<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-10">

    <div class="bg-white/70 backdrop-blur-xl border border-white/40 rounded-xl p-6 shadow hover:shadow-xl transition">
        <p class="text-gray-500 font-semibold">Total Assignments</p>
        <h3 class="text-4xl font-bold text-gray-900 mt-2">{{ total_assignments_count|default:"0" }}</h3>
    </div>

    <div class="bg-white/70 backdrop-blur-xl border border-white/40 rounded-xl p-6 shadow hover:shadow-xl transition">
        <p class="text-gray-500 font-semibold">Pending</p>
        <h3 class="text-4xl font-bold text-yellow-500 mt-2">{{ pending_assignments_count|default:"0" }}</h3>
    </div>

    <div class="bg-white/70 backdrop-blur-xl border border-white/40 rounded-xl p-6 shadow hover:shadow-xl transition">
        <p class="text-gray-500 font-semibold">Completed</p>
        <h3 class="text-4xl font-bold text-green-600 mt-2">{{ completed_assignments_count|default:"0" }}</h3>
    </div>

    <div class="bg-white/70 backdrop-blur-xl border border-white/40 rounded-xl p-6 shadow hover:shadow-xl transition">
        <p class="text-gray-500 font-semibold">Average Score</p>
        <h3 class="text-4xl font-bold text-indigo-600 mt-2">{{ average_score|default:"N/A" }}%</h3>
    </div>

</div>


<!-- Assignments + Recent Results -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-8">

    <!-- Upcoming Assignments -->
    <div class="bg-white/70 backdrop-blur-xl border border-white/40 rounded-xl p-6 shadow hover:shadow-xl transition">
        <h3 class="text-2xl font-bold text-gray-900 mb-5 flex items-center gap-2">
            ðŸ“˜ Upcoming Assignments
        </h3>

        <div class="space-y-4">

            {% for assignment in upcoming_assignments %}
                <div class="p-5 bg-gray-50 border border-gray-200 rounded-xl hover:border-gm-primary hover:bg-white transition cursor-pointer flex justify-between items-center">
                    <div>
                        <h4 class="font-bold text-gray-900">{{ assignment.title }}</h4>
                        <p class="text-sm text-red-600">Due in {{ assignment.due_date|timeuntil }}</p>
                    </div>

                    <a href="{% url 'assignment_view' assignment.id %}"
                       class="px-5 py-2 bg-gm-primary text-white rounded-lg font-semibold shadow hover:scale-105 transition">
                        Start
                    </a>
                </div>
            {% empty %}
                <div class="text-center py-10 text-gray-500">
                    ðŸŽ‰ No upcoming assignments. Great job!
                </div>
            {% endfor %}

        </div>
    </div>


    <!-- Recent Results -->
    <div class="bg-white/70 backdrop-blur-xl border border-white/40 rounded-xl p-6 shadow hover:shadow-xl transition">
        <h3 class="text-2xl font-bold text-gray-900 mb-5 flex items-center gap-2">
            ðŸ“Š Recent Results
        </h3>

        <div class="space-y-4">

            {% for result in recent_results %}
            <a href="{% url 'result_detail' result.id %}"
               class="block p-5 bg-gray-50 border border-gray-200 rounded-xl hover:border-indigo-500 hover:bg-white transition">

                <div class="flex justify-between items-center">
                    <div>
                        <h4 class="font-bold text-gray-900">{{ result.assignment.title }}</h4>
                        <p class="text-sm text-gray-500">
                            Submitted: {{ result.submission_date|date:"M d, Y" }}
                        </p>
                    </div>

                    <!-- Score Badge -->
                    <div class="text-right">
                        <p class="text-3xl font-bold
                            {% if result.score >= 90 %}text-green-600
                            {% elif result.score >= 80 %}text-blue-600
                            {% else %}text-yellow-500{% endif %}">
                            {{ result.score }}%
                        </p>

                        <p class="text-sm font-semibold
                            {% if result.score >= 90 %}text-green-600
                            {% elif result.score >= 80 %}text-blue-600
                            {% else %}text-yellow-500{% endif %}">
                            {% if result.score >= 90 %}Excellent
                            {% elif result.score >= 80 %}Good
                            {% elif result.score >= 70 %}Fair
                            {% else %}Needs Improvement{% endif %}
                        </p>
                    </div>
                </div>

            </a>
            {% empty %}
                <div class="text-center py-10 text-gray-500">
                    ðŸ“­ No graded results yet.
                </div>
            {% endfor %}

        </div>
    </div>

</div>

{% endblock %}
